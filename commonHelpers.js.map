{"version":3,"file":"commonHelpers.js","sources":["../src/js/api.js","../src/js/script.js"],"sourcesContent":["import axios from 'axios';\n\nconst apiKey = '41002139-ab30ad0ff8976a28ff14eed97';\n\nasync function fetchImages(query, page = 1, perPage = 40) {\n  const url = `https://pixabay.com/api/?key=${apiKey}&q=${encodeURIComponent(\n    query\n  )}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`;\n\n  try {\n    const response = await axios.get(url);\n    return response.data;\n  } catch (error) {\n    throw error;\n  }\n}\n\nexport { fetchImages };\n","import { fetchImages } from './api.js';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nlet currentPage = 1;\nlet totalHits = 0;\nlet totalPages = 0;\nconst perPage = 40;\nconst gallery = document.querySelector('.gallery');\nlet lightbox;\n\ndocument\n  .getElementById('search-form')\n  .addEventListener('submit', async function (event) {\n    event.preventDefault();\n    clearGallery();\n    currentPage = 1;\n    const searchQuery = event.target.elements.searchQuery.value.trim();\n    if (!searchQuery) {\n      iziToast.warning({\n        title: 'Warning',\n        message: 'Please enter a search query.',\n        position: 'topRight',\n      });\n      return;\n    }\n    await performSearch(searchQuery);\n  });\n\nwindow.addEventListener('scroll', () => {\n  if (\n    window.scrollY + window.innerHeight >=\n    document.documentElement.scrollHeight\n  ) {\n    loadMoreImages();\n  }\n});\n\nasync function loadMoreImages() {\n  const searchQuery = document\n    .getElementById('search-form')\n    .elements.searchQuery.value.trim();\n  if (!searchQuery || currentPage >= totalPages) return;\n\n  currentPage++;\n  await performSearch(searchQuery);\n}\n\nasync function performSearch(query) {\n  query = query.trim();\n  if (!query) {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Please enter a search query.',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  try {\n    const data = await fetchImages(query, currentPage, perPage);\n    totalHits = data.totalHits;\n    totalPages = Math.ceil(totalHits / perPage);\n    if (data.hits.length === 0) {\n      iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again.',\n        position: 'topRight',\n      });\n    } else {\n      displayImages(data.hits);\n      if (currentPage === 1) {\n        iziToast.success({\n          title: 'Hooray!',\n          message: `We found ${totalHits} images.`,\n          position: 'topRight',\n        });\n      }\n    }\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    iziToast.error({\n      title: 'Error',\n      message: 'Error fetching images',\n      position: 'topRight',\n    });\n  }\n}\n\nfunction displayImages(images) {\n  images.forEach(image => {\n    const cardHTML = `\n      <div class=\"photo-card\">\n        <a href=\"${image.largeImageURL}\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" />\n        </a>\n        <div class=\"info\">\n          <div class=\"info-item\">\n            <b>Likes</b>\n            <span>${image.likes}</span>\n          </div>\n          <div class=\"info-item\">\n            <b>Views</b>\n            <span>${image.views}</span>\n          </div>\n          <div class=\"info-item\">\n            <b>Comments</b>\n            <span>${image.comments}</span>\n          </div>\n          <div class=\"info-item\">\n            <b>Downloads</b>\n            <span>${image.downloads}</span>\n          </div>\n        </div>\n      </div>`;\n    gallery.insertAdjacentHTML('beforeend', cardHTML);\n  });\n\n  if (lightbox) {\n    lightbox.refresh();\n  } else {\n    lightbox = new SimpleLightbox('.gallery a', {});\n  }\n\n  if (currentPage >= totalPages) {\n    iziToast.error({\n      title: 'End of Results',\n      message:\n        'Sorry, there are no more images matching your search query. Please try again.',\n      position: 'topRight',\n    });\n  }\n\n  if (currentPage > 1) {\n    smoothScroll();\n  }\n}\n\nfunction clearGallery() {\n  gallery.innerHTML = '';\n  if (lightbox) {\n    lightbox.destroy();\n    lightbox = null;\n  }\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } =\n    gallery.firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["apiKey","fetchImages","query","page","perPage","url","axios","error","currentPage","totalHits","totalPages","gallery","lightbox","event","clearGallery","searchQuery","iziToast","performSearch","loadMoreImages","data","displayImages","images","image","cardHTML","SimpleLightbox","smoothScroll","cardHeight"],"mappings":"owBAEA,MAAMA,EAAS,qCAEf,eAAeC,EAAYC,EAAOC,EAAO,EAAGC,EAAU,GAAI,CACxD,MAAMC,EAAM,gCAAgCL,OAAY,mBACtDE,CACD,kEAAiEC,cAAiBC,IAEnF,GAAI,CAEF,OADiB,MAAME,EAAM,IAAID,CAAG,GACpB,IACjB,OAAQE,EAAP,CACA,MAAMA,CACP,CACH,CCTA,IAAIC,EAAc,EACdC,EAAY,EACZC,EAAa,EACjB,MAAMN,EAAU,GACVO,EAAU,SAAS,cAAc,UAAU,EACjD,IAAIC,EAEJ,SACG,eAAe,aAAa,EAC5B,iBAAiB,SAAU,eAAgBC,EAAO,CACjDA,EAAM,eAAc,EACpBC,IACAN,EAAc,EACd,MAAMO,EAAcF,EAAM,OAAO,SAAS,YAAY,MAAM,OAC5D,GAAI,CAACE,EAAa,CAChBC,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,+BACT,SAAU,UAClB,CAAO,EACD,MACD,CACD,MAAMC,EAAcF,CAAW,CACnC,CAAG,EAEH,OAAO,iBAAiB,SAAU,IAAM,CAEpC,OAAO,QAAU,OAAO,aACxB,SAAS,gBAAgB,cAEzBG,GAEJ,CAAC,EAED,eAAeA,GAAiB,CAC9B,MAAMH,EAAc,SACjB,eAAe,aAAa,EAC5B,SAAS,YAAY,MAAM,OAC1B,CAACA,GAAeP,GAAeE,IAEnCF,IACA,MAAMS,EAAcF,CAAW,EACjC,CAEA,eAAeE,EAAcf,EAAO,CAElC,GADAA,EAAQA,EAAM,OACV,CAACA,EAAO,CACVc,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,+BACT,SAAU,UAChB,CAAK,EACD,MACD,CAED,GAAI,CACF,MAAMG,EAAO,MAAMlB,EAAYC,EAAOM,EAAaJ,CAAO,EAC1DK,EAAYU,EAAK,UACjBT,EAAa,KAAK,KAAKD,EAAYL,CAAO,EACtCe,EAAK,KAAK,SAAW,EACvBH,EAAS,MAAM,CACb,MAAO,QACP,QACE,2EACF,SAAU,UAClB,CAAO,GAEDI,EAAcD,EAAK,IAAI,EACnBX,IAAgB,GAClBQ,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,YAAYP,YACrB,SAAU,UACpB,CAAS,EAGN,OAAQF,EAAP,CACA,QAAQ,MAAM,yBAA0BA,CAAK,EAC7CS,EAAS,MAAM,CACb,MAAO,QACP,QAAS,wBACT,SAAU,UAChB,CAAK,CACF,CACH,CAEA,SAASI,EAAcC,EAAQ,CAC7BA,EAAO,QAAQC,GAAS,CACtB,MAAMC,EAAW;AAAA;AAAA,mBAEFD,EAAM;AAAA,sBACHA,EAAM,sBAAsBA,EAAM;AAAA;AAAA;AAAA;AAAA;AAAA,oBAKpCA,EAAM;AAAA;AAAA;AAAA;AAAA,oBAINA,EAAM;AAAA;AAAA;AAAA;AAAA,oBAINA,EAAM;AAAA;AAAA;AAAA;AAAA,oBAINA,EAAM;AAAA;AAAA;AAAA,cAItBX,EAAQ,mBAAmB,YAAaY,CAAQ,CACpD,CAAG,EAEGX,EACFA,EAAS,QAAO,EAEhBA,EAAW,IAAIY,EAAe,aAAc,CAAE,CAAA,EAG5ChB,GAAeE,GACjBM,EAAS,MAAM,CACb,MAAO,iBACP,QACE,gFACF,SAAU,UAChB,CAAK,EAGCR,EAAc,GAChBiB,GAEJ,CAEA,SAASX,GAAe,CACtBH,EAAQ,UAAY,GAChBC,IACFA,EAAS,QAAO,EAChBA,EAAW,KAEf,CAEA,SAASa,GAAe,CACtB,KAAM,CAAE,OAAQC,CAAY,EAC1Bf,EAAQ,kBAAkB,wBAC5B,OAAO,SAAS,CACd,IAAKe,EAAa,EAClB,SAAU,QACd,CAAG,CACH"}